{"version":3,"sources":["../../../../../../../assets/Script/Game/Platform/JS/assets/Script/Game/Platform/JS/PlatformWX.js"],"names":["module","exports","getUserInfo","cb","wx","success","res","console","log","fail","init","self","showShareMenu","getSetting","authSetting","openSetting","onShareAppMessage","title","imageUrl","onShow","query","undefined","entryGameSourceOnShow","share","shareAppMessage","shareShortCutImage","canvas","cc","game","width","winSize","height","toTempFilePath","x","y","destWidth","destHeight","tempFilePath","rank","updateScore","score","window","postMessage","messageType","MAIN_MENU_NUM"],"mappings":"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","file":"PlatformWX.js","sourceRoot":"../../../../../../../assets/Script/Game/Platform/JS","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\n\nmodule.exports = {\n    getUserInfo(cb) {\n        wx.getUserInfo({\n            success: function (res) {\n                console.log('获取玩家信息成功');\n                console.log(res)\n                cb(null, res);\n            },\n            fail: function () {\n                console.log('获取玩家信息出错');\n                cb(\"wx:getUserInfo_fail\", null);\n            }\n        })\n    },\n    init() {\n        var self = this;\n        wx.showShareMenu();\n        //获取微信授权\n        wx.getSetting({\n            success: (res) => {\n                console.log(\"获取微信授权：\", res);\n                if (res.authSetting[\"scope.userInfo\"] == false) {\n                    wx.openSetting({\n\n                    })\n                }\n            }\n        });\n        /** 点击左上角-》转发 分享出去的内容 回调函数*/\n        wx.onShareAppMessage(() => {\n            //let shareData = gameApiCallback.shareButtonInfo();\n\n            return {\n                title: '好学生就是我，成语量超过了80%的微信好友。',\n                imageUrl: 'images/share.png',\n                success: (res) => {\n                    \n                }\n            };\n\n        });\n\n        //onshow 也可能点击分享消息进入游戏\n        wx.onShow(res => {\n            var query = res.query;\n            console.log(\"wx.onShow:\", res);\n            if (query != undefined && query['inviterId'] != undefined) {\n                console.log(\"点击分享进入\");\n            }\n            else {\n                let entryGameSourceOnShow = {};\n                entryGameSourceOnShow['res'] = res; //所有数据\n                console.log(\"自己进入\");\n            }\n        });\n    },\n    share(cb) {\n        var self = this;\n        wx.shareAppMessage({\n            // title: shareData.title,\n            // imageUrl: shareData.imageUrl,\n            // query: shareData.query,\n            title: '好学生就是我，成语量超过了80%的微信好友。',\n            imageUrl: 'images/share.png',\n            success: (res) => {\n                if (cb) {\n                    cb();\n                }\n            }\n        });\n    },\n    shareShortCutImage(cb) {\n        //截屏图片\n        var canvas = cc.game.canvas;\n        var width = cc.winSize.width;\n        var height = cc.winSize.height;\n        var self = this;\n        canvas.toTempFilePath({\n            x: 0,\n            y: height * 0.25,\n            width: width,\n            height: width * 4 / 5,\n            destWidth: width,\n            destHeight: width * 4 / 5,\n            success(res) {\n                console.log(res)\n                wx.shareAppMessage({\n                    title: '好学生就是我，成语量超过了80%的微信好友。',\n                    imageUrl: res.tempFilePath,\n                    success: (res) => {\n                        if (cb) {\n                            cb();\n                        }\n                    }\n                })\n            }\n        })\n    },\n    rank() {\n\n    },\n    updateScore(score) {\n        window.wx.postMessage({\n            messageType: 3,\n            MAIN_MENU_NUM: \"x1\",\n            score: score,\n        });\n    },\n}\n"]}