{"version":3,"sources":["MenuController.ts"],"names":[],"mappings":";;;;AAAA,oBAAoB;AACpB,iFAAiF;AACjF,yFAAyF;AACzF,mBAAmB;AACnB,2FAA2F;AAC3F,mGAAmG;AACnG,8BAA8B;AAC9B,2FAA2F;AAC3F,mGAAmG;;AAE7F,IAAA,kBAAqC,EAAnC,oBAAO,EAAE,sBAAQ,CAAmB;AAE5C,iDAA2C;AAG3C;IAA4C,kCAAY;IADxD;QAAA,qEA8GC;QA1GG,sBAAgB,GAAG,IAAI,CAAC;QAExB,iBAAW,GAAG,IAAI,CAAC;QACnB,UAAI,GAAG,IAAI,CAAC;QAGZ,aAAO,GAAG,IAAI,CAAC;QAEf,cAAQ,GAAG,IAAI,CAAC;QAEhB,SAAG,GAAG,IAAI,CAAC;QAEX,gBAAU,GAAG,IAAI,CAAC;QAElB,gBAAU,GAAG,IAAI,CAAC;QAElB,eAAS,GAAG,IAAI,CAAC;QACjB,cAAQ,GAAG,IAAI,CAAC;;QAwFhB,iBAAiB;IACrB,CAAC;IAvFG,+BAAM,GAAN;QAAA,iBAaC;QAZG,IAAI,CAAC,IAAI,GAAG,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,YAAY,CAAC,aAAa,CAAC,CAAC;QAEzE,kBAAQ,CAAC,WAAW,CAAC,UAAC,KAAK,EAAE,IAAI;YAC7B,IAAI,KAAK,IAAI,IAAI,IAAI,IAAI,CAAC,QAAQ,IAAI,SAAS,EAAE;gBAC7C,IAAM,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC;gBAC/B,KAAI,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,QAAQ,CAAC,QAAQ,EAAE,QAAQ,CAAC,SAAS,CAAC,CAAC,CAAC;aAClE;QACL,CAAC,CAAC,CAAA;QACF,kBAAQ,CAAC,IAAI,EAAE,CAAC;QAChB,2FAA2F;QAC3F,sDAAsD;QACtD,IAAI,CAAC,aAAa,EAAE,CAAC;IACzB,CAAC;IAED,8BAAK,GAAL;IAEA,CAAC;IAED,sCAAa,GAAb;QACI,2CAA2C;QAE3C,IAAI,EAAE,GAAG,IAAI,CAAC,IAAI,CAAC,KAAK,EAAE,CAAC;QAC3B,IAAI,QAAQ,GAAG,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC;QACvC,IAAI,KAAK,GAAG,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE,CAAC;QACjC,IAAI,KAAK,GAAG,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE,CAAC;QAEjC,UAAU;QACV,mBAAmB;QACnB,sEAAsE;QACtE,6BAA6B;QAC7B,IAAI;QAEJ,gCAAgC;QAChC,kCAAkC;QAClC,8BAA8B;QAC9B,kBAAkB;QAClB,wBAAwB;QACxB,oBAAoB;QACpB,8CAA8C;QAC9C,oBAAoB;QACpB,eAAe;QACf,oBAAoB;QACpB,QAAQ;QACR,oDAAoD;QACpD,IAAI;QACJ,kCAAkC;QAClC,kCAAkC;QAElC,IAAI,CAAC,OAAO,CAAC,MAAM,GAAG,EAAE,CAAC;QACzB,IAAI,WAAW,GAAG,IAAI,CAAC,QAAQ,CAAC,YAAY,CAAC,EAAE,CAAC,WAAW,CAAC,CAAC;QAC7D,IAAI,QAAQ,GAAG,GAAG,EAAE;YAChB,IAAI,CAAC,GAAG,CAAC,IAAI,GAAG,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC;SACzC;aAAM;YACH,IAAI,CAAC,GAAG,CAAC,IAAI,GAAG,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC;SACxC;QACD,WAAW,CAAC,QAAQ,GAAG,QAAQ,CAAC;QAChC,IAAI,CAAC,UAAU,CAAC,MAAM,GAAG,KAAK,CAAC;QAC/B,IAAI,CAAC,UAAU,CAAC,MAAM,GAAG,KAAK,CAAC;IACnC,CAAC;IAED,uCAAc,GAAd;QACI,IAAI,CAAC,QAAQ,EAAE,CAAC;IACpB,CAAC;IAED,oCAAW,GAAX;QACI,EAAE,CAAC,QAAQ,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC;IACvC,CAAC;IAED,mCAAU,GAAV;QACI,EAAE,CAAC,QAAQ,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC;IACvC,CAAC;IAED,oCAAW,GAAX;QACI,IAAI,CAAC,QAAQ,EAAE,CAAC;IACpB,CAAC;IAED,iCAAQ,GAAR;QACI,IAAI,IAAI,GAAG,IAAI,CAAC;QAChB,kBAAQ,CAAC,KAAK,CAAC,CAAC,EAAE;YACd,IAAI,KAAK,GAAG,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE,CAAC,CAAC;YAC3C,KAAK,IAAI,CAAC,CAAC;YACX,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;YAC1B,IAAI,CAAC,UAAU,CAAC,MAAM,GAAG,KAAK,CAAC;QACnC,CAAC,CAAC,CAAC;IACP,CAAC;IAxGD;QADC,QAAQ,CAAC,EAAE,CAAC,MAAM,CAAC;4DACI;IAExB;QADC,QAAQ,CAAC,EAAE,CAAC,MAAM,CAAC;uDACD;IAInB;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;mDACJ;IAEf;QADC,QAAQ,CAAC,EAAE,CAAC,WAAW,CAAC;oDACT;IAEhB;QADC,QAAQ,CAAC,EAAE,CAAC,MAAM,CAAC;+CACT;IAEX;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;sDACD;IAElB;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;sDACD;IAjBD,cAAc;QADlC,OAAO;OACa,cAAc,CA6GlC;IAAD,qBAAC;CA7GD,AA6GC,CA7G2C,EAAE,CAAC,SAAS,GA6GvD;kBA7GoB,cAAc","file":"","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\Script\\Game\\Controller","sourcesContent":["// Learn TypeScript:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/typescript.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\nimport Platform from \"../Platform/Platform\"\r\n\r\n@ccclass\r\nexport default class MenuController extends cc.Component {\r\n\r\n    @property(cc.Prefab)\r\n    localDataManager = null;\r\n    @property(cc.Prefab)\r\n    userManager = null;\r\n    user = null;\r\n\r\n    @property(cc.Label)\r\n    lvLabel = null;\r\n    @property(cc.ProgressBar)\r\n    progress = null;\r\n    @property(cc.Sprite)\r\n    bar = null;\r\n    @property(cc.Label)\r\n    powerLabel = null;\r\n    @property(cc.Label)\r\n    moneyLabel = null;\r\n\r\n    localData = null;\r\n    rankData = null;\r\n\r\n    onLoad() {\r\n        this.user = cc.instantiate(this.userManager).getComponent('UserManager');\r\n\r\n        Platform.getUserInfo((error, data) => {\r\n            if (error == null && data.userInfo != undefined) {\r\n                const userInfo = data.userInfo;\r\n                this.user.setUserInfo([userInfo.nickName, userInfo.avatarUrl]);\r\n            }\r\n        })\r\n        Platform.init();\r\n        // this.localData = cc.instantiate(this.localDataManager).getComponent('LocalDataManager');\r\n        // this.localData.parseRank(this.getLvAndScroe, this);\r\n        this.getLvAndScroe();\r\n    }\r\n\r\n    start() {\r\n\r\n    }\r\n\r\n    getLvAndScroe() {\r\n        // this.rankData = this.localData.rankData;\r\n\r\n        var lv = this.user.getLv();\r\n        var progress = this.user.getProgress();\r\n        var power = this.user.getPower();\r\n        var money = this.user.getMoney();\r\n\r\n        //初始化新手引导，\r\n        //两步必须都完成，否则重置到最初阶段\r\n        // if (!this.user.getIsShowGuide0() || !this.user.getIsShowGuide1()) {\r\n        //     this.user.initGuide();\r\n        // }\r\n\r\n        // var rank = this.rankData[lv];\r\n        // var rank_arr = rank.split(',');\r\n        // if (rank_arr.length >= 2) {\r\n        //     var s = \"\";\r\n        //     if (score < 60) {\r\n        //         s = \"学渣\";\r\n        //     } else if (60 <= score && score < 90) {\r\n        //         s = \"学霸\";\r\n        //     } else {\r\n        //         s = \"学神\";\r\n        //     }\r\n        //     this.lvLabel.string = rank_arr[1] + \"  \" + s;\r\n        // }\r\n        // this.scoreLabel.string = score;\r\n        // this.scoreLabel.active = false;\r\n\r\n        this.lvLabel.string = lv;\r\n        let progressBar = this.progress.getComponent(cc.ProgressBar);\r\n        if (progress > 0.9) {\r\n            this.bar.type = cc.Sprite.Type.SLICED;\r\n        } else {\r\n            this.bar.type = cc.Sprite.Type.TILED;\r\n        }\r\n        progressBar.progress = progress;\r\n        this.powerLabel.string = power;\r\n        this.moneyLabel.string = money;\r\n    }\r\n\r\n    addPowerAction() {\r\n        this.addPower();\r\n    }\r\n\r\n    beginAction() {\r\n        cc.director.loadScene(\"PlayScene\");\r\n    }\r\n\r\n    rankAction() {\r\n        cc.director.loadScene('RankScene');\r\n    }\r\n\r\n    shareAction() {\r\n        this.addPower();\r\n    }\r\n\r\n    addPower() {\r\n        var self = this;\r\n        Platform.share(0, () => {\r\n            var power = parseInt(self.user.getPower());\r\n            power += 2;\r\n            self.user.setPower(power);\r\n            self.powerLabel.string = power;\r\n        });\r\n    }\r\n    // update (dt) {}\r\n}\r\n"]}