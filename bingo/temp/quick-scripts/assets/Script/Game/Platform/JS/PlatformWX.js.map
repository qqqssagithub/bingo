{"version":3,"sources":["PlatformWX.js"],"names":["module","exports","getUserInfo","cb","wx","success","res","console","log","fail","init","self","showShareMenu","getSetting","authSetting","openSetting","onShareAppMessage","title","imageUrl","onShow","query","undefined","entryGameSourceOnShow","share","shareAppMessage","shareShortCutImage","canvas","cc","game","width","winSize","height","toTempFilePath","x","y","destWidth","destHeight","tempFilePath","rank","updateScore","score","window","postMessage","messageType","MAIN_MENU_NUM"],"mappings":"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","file":"PlatformWX.js","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\Script\\Game\\Platform\\JS","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\r\n\r\nmodule.exports = {\r\n    getUserInfo(cb) {\r\n        wx.getUserInfo({\r\n            success: function (res) {\r\n                console.log('获取玩家信息成功');\r\n                console.log(res)\r\n                cb(null, res);\r\n            },\r\n            fail: function () {\r\n                console.log('获取玩家信息出错');\r\n                cb(\"wx:getUserInfo_fail\", null);\r\n            }\r\n        })\r\n    },\r\n    init() {\r\n        var self = this;\r\n        wx.showShareMenu();\r\n        //获取微信授权\r\n        wx.getSetting({\r\n            success: (res) => {\r\n                console.log(\"获取微信授权：\", res);\r\n                if (res.authSetting[\"scope.userInfo\"] == false) {\r\n                    wx.openSetting({\r\n\r\n                    })\r\n                }\r\n            }\r\n        });\r\n        /** 点击左上角-》转发 分享出去的内容 回调函数*/\r\n        wx.onShareAppMessage(() => {\r\n            //let shareData = gameApiCallback.shareButtonInfo();\r\n\r\n            return {\r\n                title: '好学生就是我，成语量超过了80%的微信好友。',\r\n                imageUrl: 'images/share.png',\r\n                success: (res) => {\r\n                    \r\n                }\r\n            };\r\n\r\n        });\r\n\r\n        //onshow 也可能点击分享消息进入游戏\r\n        wx.onShow(res => {\r\n            var query = res.query;\r\n            console.log(\"wx.onShow:\", res);\r\n            if (query != undefined && query['inviterId'] != undefined) {\r\n                console.log(\"点击分享进入\");\r\n            }\r\n            else {\r\n                let entryGameSourceOnShow = {};\r\n                entryGameSourceOnShow['res'] = res; //所有数据\r\n                console.log(\"自己进入\");\r\n            }\r\n        });\r\n    },\r\n    share(cb) {\r\n        var self = this;\r\n        wx.shareAppMessage({\r\n            // title: shareData.title,\r\n            // imageUrl: shareData.imageUrl,\r\n            // query: shareData.query,\r\n            title: '好学生就是我，成语量超过了80%的微信好友。',\r\n            imageUrl: 'images/share.png',\r\n            success: (res) => {\r\n                if (cb) {\r\n                    cb();\r\n                }\r\n            }\r\n        });\r\n    },\r\n    shareShortCutImage(cb) {\r\n        //截屏图片\r\n        var canvas = cc.game.canvas;\r\n        var width = cc.winSize.width;\r\n        var height = cc.winSize.height;\r\n        var self = this;\r\n        canvas.toTempFilePath({\r\n            x: 0,\r\n            y: height * 0.25,\r\n            width: width,\r\n            height: width * 4 / 5,\r\n            destWidth: width,\r\n            destHeight: width * 4 / 5,\r\n            success(res) {\r\n                console.log(res)\r\n                wx.shareAppMessage({\r\n                    title: '好学生就是我，成语量超过了80%的微信好友。',\r\n                    imageUrl: res.tempFilePath,\r\n                    success: (res) => {\r\n                        if (cb) {\r\n                            cb();\r\n                        }\r\n                    }\r\n                })\r\n            }\r\n        })\r\n    },\r\n    rank() {\r\n\r\n    },\r\n    updateScore(score) {\r\n        window.wx.postMessage({\r\n            messageType: 3,\r\n            MAIN_MENU_NUM: \"x1\",\r\n            score: score,\r\n        });\r\n    },\r\n}\r\n"]}